name: cis-aws-foundations-baseline
title: cis-aws-foundations-baseline
maintainer: MITRE InSpec Team
copyright: MITRE, 2018
copyright_email: inspec@mitre.org
license: Apache-2.0
summary: 'InSpec Profile to validate the CIS AWS Foundations Benchmark v1.1.0'
version: 1.0.0
supports:
  - platform: aws
inspec_version: "~> 3.0"

attributes:
  - name: default_aws_region
    description: 'default aws region'
    default: 'us-east-1'

  - name: aws_regions
    description: 'all aws regions to be inspected'
    default:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2

  - name: aws_key_age
    description: 'The maximum allowed key age'
    type: numeric
    default: 90

  - name: pwd_length
    description: 'Required password length'
    type: numeric
    default: 14

  - name: aws_cred_age
    description: 'The maximum allowed IAM account age'
    type: numeric
    default: 90

  - name: iam_manager_role_name
    description: 'iam manager role name'
    type: string
    default: 'iam-manager-role-name'

  - name: iam_master_role_name
    description: 'iam master role name'
    type: string
    default: 'iam-master-role-name'

  - name: iam_manager_user_name
    description: 'iam manager user name'
    type: string
    default: 'iam-manager-user-name'

  - name: iam_master_user_name
    description: 'iam master user name'
    type: string
    default: 'iam-master-user-name'

  - name: iam_manager_policy_name
    description: 'iam manager policy'
    type: string
    default: 'iam-manager-policy'

  - name: iam_master_policy_name
    description: 'iam master policy'
    type: string
    default: 'iam-master-policy'

  - name: exception_bucket_list
    description: 'list of buckets exempted from inspection'
    type: array
    default:
      - exception_bucket_name

  - name: config_delivery_channels
    description: 'Config service settings'
    type: hash
    default:
      us-east-1:
        s3_bucket_name: s3_bucket_name_value
        sns_topic_arn: sns_topic_arn_value
      us-east-2:
        s3_bucket_name: s3_bucket_name_value
        sns_topic_arn: sns_topic_arn_value
      us-west-1:
        s3_bucket_name: s3_bucket_name_value
        sns_topic_arn: sns_topic_arn_value
      us-west-2:
        s3_bucket_name: s3_bucket_name_value
        sns_topic_arn: sns_topic_arn_value

  - name: sns_topics
    description: 'SNS topics list and details'
    type: hash
    default:
      topic_arn1:
        owner: owner_value
        region: region_value
      topic_arn2:
        owner: owner_value
        region: region_value

  - name: sns_subscriptions
    description: 'SNS subscription list and details'
    type: hash
    default:
      subscription_arn1:
        endpoint: endpoint_value
        owner: owner_value
        protocol: protocol_value
      subscription_arn2:
        endpoint: endpoint_value
        owner: owner_value
        protocol: protocol_value

  - name: exception_security_group_list
    description: 'list of security groups exempted from inspection'
    type: array
    default:
      - 'exception_security_group_name'

  - name: service_account_mfa_exceptions
    description: 'list of service accounts which are exempt from the MFA requirement'
    type: array
    default:
      -
